# BattleScan

This repository contains instructions for running the **BattleScan** subsystem. The process is outlined in the following steps:

## 1. Dataset Preparation

For the BattleScan dataset, We need to ensure that the division of the dataset is consistent with MatchScope subsystem. Therefore we need to refer to the previous dataset for segmentation.

```sh
$ python gen_data.py ../ExtractData/BlackEigenvalue_battleBehavior.csv ../ExtractData/WhiteEigenvalue_battleBehavior.csv ../1_MatchScope/dataset
```

The first two options are the file paths to the cheater battle behavior feature data and the normal player battle behavior feature data generated by the previous step (**Preprocess**). And the third option is the folder path to subsystem MatchScope's dataset.

Then, we can get the `dataset` folder with the same file structure as the MatchScope dataset.

```markdown
.
└── 2_BattleScan
    ├── dataset/
    │   ├── mobile/
    │   │   ├── final_test.csv
    │   │   ├── final_train.csv
    │   │   ├── final_val.csv
    │   └── pc/
    │       ├── final_test.csv
    │       ├── final_train.csv
    │       └── final_val.csv
    └── other folders and scripts ...
```

## 2. Downsampling Training Data

Due to imbalanced positive and negative samples in the dataset, it's essential to downsample the training set for effective model training:

```sh
$ python downsample_train.py dataset/mobile/final_train.csv
```

This script generates several sub-training datasets in the `dataset/mobile` folder based on the ratio of positive to negative samples. If you want to train the `pc` platform, just modify the `dataset/mobile/final_train.csv` option to `dataset/pc/final_train.csv`.

## 3. Training Models

We need to train each sub-dataset of data separately, for example:

```sh
$ python BattleScan_train.py 1 mobile
```

The first option is the serial number of sub-training sets and the second option is the platform type of the training data. We have provided the trained models in the corresponding datasets. Please check `mobile` and `pc` folder, which contains training data and models.

## 4. Testing Models

After training, run the script to test the models.

```sh
$ ./test.sh 13 mobile
```

The options here are the same as the first and second options of the previous subsystem script (**MatchScope**). The validation and testing rsults will be saved in the same folder as training process under`mobile` and `pc` folder.

## 5. Evaluating Predictions

First, enter the `eval` folder and run the `merge_pred.py` script to merge all prediction results. You can choose to merge both validation and test results or just one of them (add the option `test` or `val`):

```sh
$ cd eval && python merge_pred.py mobile
```

The option is the platform type (`mobile` or `pc`) of your evaluation target.
After running the script, you will obtain the final prediction results for the MatchScope subsystem in the specified folder (test/val). Then, run the `evaluation.py` script to obtain the model's evaluation metrics, which will be displayed in the terminal and saved in the respective folder:

```sh
$ python evaluation.py mobile
```

Similar to the merge script, selecting the platform type and you can also choose to evaluate results for a specific dataset, just add the option `test` or `val`.